<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Forage.js by fergiemcdowall</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Forage.js</h1>
        <p>Forage.js is an experimental search engine based on Node.js and LevelDB</p>

        <p class="view"><a href="https://github.com/fergiemcdowall/forage">View the Project on GitHub <small>fergiemcdowall/forage</small></a></p>


        <ul>
          <li><a href="https://github.com/fergiemcdowall/forage/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/fergiemcdowall/forage/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/fergiemcdowall/forage">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <p><strong>Table of Contents</strong>  <em>generated with <a href="http://doctoc.herokuapp.com/">DocToc</a></em></p>

<ul>
<li><a href="#installation">Installation</a></li>
<li>
<a href="#operation">Operation</a>

<ul>
<li>
<a href="#start-your-foragejs-server">Start your Forage.js server</a>

<ul>
<li><a href="#startup-options">Startup options</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#crawling">Crawling</a>

<ul>
<li><a href="#forage-fetch">forage-fetch</a></li>
<li><a href="#forage-document-processor">forage-document-processor</a></li>
<li><a href="#forage-indexer">forage-indexer</a></li>
</ul>
</li>
<li>
<a href="#indexing-api">Indexing API</a>

<ul>
<li><a href="#document-format">Document Format</a></li>
<li><a href="#http-interface">HTTP Interface</a></li>
<li><a href="#forage-indexer-1">Forage-indexer</a></li>
<li>
<a href="#indexing-parameters">Indexing parameters</a>

<ul>
<li><a href="#filteron">filterOn</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#search-api">Search API</a>

<ul>
<li>
<a href="#search-parameters">Search parameters</a>

<ul>
<li><a href="#q">q</a></li>
<li><a href="#searchfields">searchFields</a></li>
<li><a href="#facets">facets</a></li>
<li><a href="#filter">filter</a></li>
<li><a href="#offset">offset</a></li>
<li><a href="#pagesize">pagesize</a></li>
<li><a href="#teaser">teaser</a></li>
<li><a href="#weight">weight</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#matcher-api">Matcher API</a>

<ul>
<li><a href="#generating-a-matcher">Generating a matcher</a></li>
<li><a href="#connecting-to-a-matcher">Connecting to a matcher</a></li>
</ul>
</li>
<li><a href="#about-forage">About Forage</a></li>
<li><a href="#known-issues">Known Issues</a></li>
<li><a href="#license">License</a></li>
</ul><h1>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h1>

<p>Confirm that node.js is set up correctly, then install Forage like so:</p>

<pre><code>$ npm install -g forage
</code></pre>

<p><strong>Notes:</strong></p>

<ol>
<li>You need admin priviledges to install globally- on mac and linux use sudo: <code>$ sudo npm install -g forage</code>.</li>
<li>Forage can also be installed into the current working directory by dropping the <code>-g</code> flag: <code>$ npm install forage</code>. Forage now exists in the <code>node_modules</code> directory. From the directory you ran the install command, type: <code>$ node_modules/forage/bin/forage</code> to start forage.</li>
</ol><p>If everything went to plan- Forage should now be installed on your machine</p>

<h1>
<a name="operation" class="anchor" href="#operation"><span class="octicon octicon-link"></span></a>Operation</h1>

<p><em>Note: for the purposes of accessability, this doc assumes that Forage is being installed locally on your own computer
(localhost). Once Forage is rolled out on to remote servers, the
hostname on all URLs should be updated accordingly. Command line
commands are denoted by the prefix <code>$</code> which should not be typed in</em></p>

<h2>
<a name="start-your-foragejs-server" class="anchor" href="#start-your-foragejs-server"><span class="octicon octicon-link"></span></a>Start your Forage.js server</h2>

<p>Type</p>

<pre><code>$ forage
</code></pre>

<p>Hurrah! Forage is now running locally on your machine. Head over to <a href="http://localhost:3000/">http://localhost:3000/</a>
and marvel. The default port of 3000 can be modified if required.</p>

<h3>
<a name="startup-options" class="anchor" href="#startup-options"><span class="octicon octicon-link"></span></a>Startup options</h3>

<pre><code>$ forage --help

  Usage: forage [options]

  Options:

      -h, --help         output usage information
      -V, --version      output the version number
      -p, --port &lt;port&gt;  specify the port, defaults to 3000
</code></pre>

<h1>
<a name="crawling" class="anchor" href="#crawling"><span class="octicon octicon-link"></span></a>Crawling</h1>

<p>Forage has command line tools for spidering, fetching, processing and indexing webpages that can be installed seperately</p>

<h2>
<a name="forage-fetch" class="anchor" href="#forage-fetch"><span class="octicon octicon-link"></span></a>forage-fetch</h2>

<p>Get your webpages with <a href="https://github.com/fergiemcdowall/forage-fetch">forage-fetch</a></p>

<p><strong>Install:</strong></p>

<p><code>$ npm install -g forage-fetch</code></p>

<p><strong>Help:</strong></p>

<p><code>$ forage-fetch -h</code> or <a href="https://github.com/fergiemcdowall/forage-fetch">read the docs</a></p>

<h2>
<a name="forage-document-processor" class="anchor" href="#forage-document-processor"><span class="octicon octicon-link"></span></a>forage-document-processor</h2>

<p>Turn your fetched webpages into JSON with <a href="https://github.com/fergiemcdowall/forage-document-processor">forage-document-processor</a></p>

<p><strong>Install:</strong></p>

<p><code>$ npm install -g forage-document-processor</code></p>

<p><strong>Help:</strong></p>

<p><code>$ forage-document-processor -h</code> or <a href="https://github.com/fergiemcdowall/forage-document-processor">read the docs</a></p>

<h2>
<a name="forage-indexer" class="anchor" href="#forage-indexer"><span class="octicon octicon-link"></span></a>forage-indexer</h2>

<p>Index your JSONified webpages with <a href="https://github.com/fergiemcdowall/forage-indexer">forage-indexer</a></p>

<p><strong>Install:</strong></p>

<p><code>$ npm install -g forage-indexer</code></p>

<p><strong>Help:</strong></p>

<p><code>$ forage-indexer -h</code> or <a href="https://github.com/fergiemcdowall/forage-indexer">read the docs</a></p>

<h1>
<a name="indexing-api" class="anchor" href="#indexing-api"><span class="octicon octicon-link"></span></a>Indexing API</h1>

<h2>
<a name="document-format" class="anchor" href="#document-format"><span class="octicon octicon-link"></span></a>Document Format</h2>

<p>Generally Forage indexes data that is in the format below, that is to say an object containing a list of key:values where the key is the document ID and the values are a futher
list of key:values that define the fields. Fields can be called anything other than 'ID'. Field values can be either
strings or simple arrays. Arrays can be used to create filters and facets.</p>

<div class="highlight highlight-javascript"><pre><span class="p">{</span>
  <span class="s1">'doc1'</span><span class="o">:</span><span class="p">{</span>
    <span class="s1">'title'</span><span class="o">:</span><span class="s1">'A really interesting document'</span><span class="p">,</span>
    <span class="s1">'body'</span><span class="o">:</span><span class="s1">'This is a really interesting document'</span><span class="p">,</span>
    <span class="s1">'metadata'</span><span class="o">:</span><span class="p">[</span><span class="s1">'red'</span><span class="p">,</span> <span class="s1">'potato'</span><span class="p">]</span>
  <span class="p">},</span>
  <span class="s1">'doc2'</span><span class="o">:</span><span class="p">{</span>
    <span class="s1">'title'</span><span class="o">:</span><span class="s1">'Another interesting document'</span><span class="p">,</span>
    <span class="s1">'body'</span><span class="o">:</span><span class="s1">'This is another really interesting document that is a bit different'</span><span class="p">,</span>
    <span class="s1">'metadata'</span><span class="o">:</span><span class="p">[</span><span class="s1">'yellow'</span><span class="p">,</span> <span class="s1">'potato'</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h2>
<a name="http-interface" class="anchor" href="#http-interface"><span class="octicon octicon-link"></span></a>HTTP Interface</h2>

<p>If the above was in a file called <code>data.json</code>, it could be indexed using a command like</p>

<pre><code>curl --form document=@data.json http://localhost:3000/indexer --form filterOn=metedata
</code></pre>

<p>There is some test data in the test/testdata folder of the forage.js package. It can be indexed like so:</p>

<pre><code>curl --form document=@reuters-000.json http://localhost:3000/indexer --form filterOn=places,topics,organisations
</code></pre>

<h2>
<a name="forage-indexer-1" class="anchor" href="#forage-indexer-1"><span class="octicon octicon-link"></span></a>Forage-indexer</h2>

<p>Forage can optionally be indexed using the <a href="#forage-indexer">forage-indexer node app</a>.</p>

<h2>
<a name="indexing-parameters" class="anchor" href="#indexing-parameters"><span class="octicon octicon-link"></span></a>Indexing parameters</h2>

<h3>
<a name="filteron" class="anchor" href="#filteron"><span class="octicon octicon-link"></span></a>filterOn</h3>

<p>Example</p>

<pre><code> --form filterOn=places,topics,organisations
</code></pre>

<p>filterOn is an array of fields that can be used to filter search results. Each defined field must be an array field in
the document. filterOn will not work with string fields.</p>

<h1>
<a name="search-api" class="anchor" href="#search-api"><span class="octicon octicon-link"></span></a>Search API</h1>

<p>Search is available on <a href="http://localhost.com:3000/search">http://localhost.com:3000/search</a></p>

<h2>
<a name="search-parameters" class="anchor" href="#search-parameters"><span class="octicon octicon-link"></span></a>Search parameters</h2>

<h3>
<a name="q" class="anchor" href="#q"><span class="octicon octicon-link"></span></a>q</h3>

<p><strong>(Required)</strong> For "query". The search term. Asterisk (<code>*</code>) returns everything.</p>

<p>Usage:</p>

<pre><code>q=&lt;query term&gt;
</code></pre>

<p><a href="http://localhost:3000/search?q=moscow">http://localhost:3000/search?q=moscow</a></p>

<h3>
<a name="searchfields" class="anchor" href="#searchfields"><span class="octicon octicon-link"></span></a>searchFields</h3>

<p>Search on specified fields. Ignore text that exists in other fields.</p>

<pre><code>searchFields[]=&lt;field to search in&gt;
</code></pre>

<p><a href="http://localhost:3000/search?q=plans&amp;searchFields%5B%5D=body">http://localhost:3000/search?q=plans&amp;searchFields[]=body</a></p>

<h3>
<a name="facets" class="anchor" href="#facets"><span class="octicon octicon-link"></span></a>facets</h3>

<p><strong>(Optional)</strong> For "facet". The fields that will be used to create faceted navigation</p>

<p>Usage:</p>

<pre><code>facets=&lt;field to facet on&gt;
</code></pre>

<p><a href="http://localhost:3000/search?q=moscow&amp;facets=topics">http://localhost:3000/search?q=moscow&amp;facets=topics</a></p>

<h3>
<a name="filter" class="anchor" href="#filter"><span class="octicon octicon-link"></span></a>filter</h3>

<p><strong>(Optional)</strong> For "filter". Use this option to limit your search to the given field</p>

<p>Usage:</p>

<pre><code>filter[&lt;filter field&gt;][]=&lt;value&gt;
</code></pre>

<p><a href="http://localhost:3000/search?q=moscow&amp;facets=topics&amp;filter%5Btopics%5D%5B%5D=grain">http://localhost:3000/search?q=moscow&amp;facets=topics&amp;filter[topics][]=grain&amp;filter[topics][]=acq</a></p>

<p>Multiple filters:</p>

<p><a href="http://localhost:3000/search?q=moscow&amp;facets=topics&amp;filter%5Btopics%5D%5B%5D=grain&amp;filter%5Btopics%5D%5B%5D=acq&amp;filter%5Bplaces%5D%5B%5D=ussr">http://localhost:3000/search?q=moscow&amp;facets=topics&amp;filter[topics][]=grain&amp;filter[topics][]=acq&amp;filter[places][]=ussr</a></p>

<h3>
<a name="offset" class="anchor" href="#offset"><span class="octicon octicon-link"></span></a>offset</h3>

<p><strong>(Optional)</strong> The index in the resultSet that the server
  returns. Userful for paging.</p>

<p>Usage:</p>

<pre><code>offset=&lt;start index&gt;
</code></pre>

<p><a href="http://localhost:3000/search?q=moscow&amp;facets=topics&amp;filter%5Btopics%5D%5B%5D=grain&amp;offset=5">http://localhost:3000/search?q=moscow&amp;facets=topics&amp;filter[topics][]=grain&amp;offset=5</a></p>

<h3>
<a name="pagesize" class="anchor" href="#pagesize"><span class="octicon octicon-link"></span></a>pagesize</h3>

<p><strong>(Optional)</strong> defines the size of the resultset (defaults to 20)</p>

<p>Usage:</p>

<pre><code>pagesize=&lt;size of resultset&gt;
</code></pre>

<p><a href="http://localhost:3000/search?q=moscow&amp;facets=topics&amp;filter%5Btopics%5D%5B%5D=grain&amp;offset=5&amp;pagesize=5">http://localhost:3000/search?q=moscow&amp;facets=topics&amp;filter[topics][]=grain&amp;offset=5&amp;pagesize=5</a></p>

<h3>
<a name="teaser" class="anchor" href="#teaser"><span class="octicon octicon-link"></span></a>teaser</h3>

<p><strong>(Optional)</strong> for "teaser". Use this option to generate a short paragraph that indicates where the search terms occur in the document.</p>

<p>Usage:</p>

<pre><code>teaser=&lt;field to generate teaser on&gt;
</code></pre>

<p><a href="http://localhost:3000/search?q=moscow&amp;facets=topics&amp;filter%5Btopics%5D%5B%5D=grain&amp;offset=5&amp;pagesize=5&amp;teaser=body">http://localhost:3000/search?q=moscow&amp;facets=topics&amp;filter[topics][]=grain&amp;offset=5&amp;pagesize=5&amp;teaser=body</a></p>

<h3>
<a name="weight" class="anchor" href="#weight"><span class="octicon octicon-link"></span></a>weight</h3>

<p><strong>(Optional)</strong> For "weight". Use this option to tune relevancy by assigning weight to given fields. Weights can be arbitralily large.</p>

<p>Usage:</p>

<pre><code>weight[&lt;field name&gt;][]:&lt;weight (factor)&gt;
</code></pre>

<p><a href="http://localhost:3000/search?q=moscow&amp;facets=topics&amp;filter%5Btopics%5D%5B%5D=grain&amp;weight%5Btitle%5D%5B%5D=10">http://localhost:3000/search?q=moscow&amp;facets=topics&amp;filter[topics][]=grain&amp;weight[title][]=10</a></p>

<p>Multiple field weights:</p>

<p><a href="http://localhost:3000/search?q=moscow&amp;facets=topics&amp;filter%5Btopics%5D%5B%5D=grain&amp;weight%5Btitle%5D%5B%5D=10&amp;weight%5Bbody%5D%5B%5D=2">http://localhost:3000/search?q=moscow&amp;facets=topics&amp;filter[topics][]=grain&amp;weight[title][]=10&amp;weight[body][]=2</a></p>

<h1>
<a name="matcher-api" class="anchor" href="#matcher-api"><span class="octicon octicon-link"></span></a>Matcher API</h1>

<p>Forage comes with a matcher that can be used to create autosuggest functionality. The matcher is derived from the content of the reverse index. At the moment Forage ships with one matcher,
there is a desire to abstract this out into a framework that can accomodate mulitiple pluggable matchers.</p>

<h2>
<a name="generating-a-matcher" class="anchor" href="#generating-a-matcher"><span class="octicon octicon-link"></span></a>Generating a matcher</h2>

<p>Make sure that you have some documents in your index and then run:</p>

<pre><code>http://localhost:3000/generateMatcher
</code></pre>

<h2>
<a name="connecting-to-a-matcher" class="anchor" href="#connecting-to-a-matcher"><span class="octicon octicon-link"></span></a>Connecting to a matcher</h2>

<p>Using something like <a href="http://twitter.github.io/typeahead.js/">Typeahead</a> or <a href="http://jqueryui.com/autocomplete/">JQuery autocomplete</a> the matcher can be called by using this URL:</p>

<pre><code>http://localhost:3000/matcher?beginsWith=&lt;matcher term&gt;
</code></pre>

<h1>
<a name="about-forage" class="anchor" href="#about-forage"><span class="octicon octicon-link"></span></a>About Forage</h1>

<p>Forage.js is an experimental search engine built with <a href="http://nodejs.org/">Node.js</a> and <a href="https://github.com/fergiemcdowall/search-index">search-index</a> featuring</p>

<ul>
<li>Full text search</li>
<li>Stopword removal</li>
<li>Faceting</li>
<li>Filtering</li>
<li>Matching (Autosuggest)</li>
<li>Fielded search</li>
<li>Field weighting</li>
<li>Relevance weighting (tf-idf)</li>
<li>Paging (offset and resultset length)</li>
<li>Virtualisation (see <a href="https://github.com/fergiemcdowall/virtual-forage">virtual-forage</a>)</li>
</ul><p><strong>Homepage:</strong> <a href="http://www.foragejs.net">http://www.foragejs.net</a></p>

<p><strong>Github:</strong> <a href="https://github.com/fergiemcdowall/forage">https://github.com/fergiemcdowall/forage</a></p>

<p><strong>Build Status Master Branch:</strong> <a href="http://travis-ci.org/fergiemcdowall/forage"><img src="https://secure.travis-ci.org/fergiemcdowall/forage.png" alt="Build Status"></a></p>

<p><a href="https://nodei.co/npm/forage/"><img src="https://nodei.co/npm/forage.png?stars&amp;downloads" alt="NPM"></a></p>

<p><a href="https://nodei.co/npm/forage/"><img src="https://nodei.co/npm-dl/forage.png" alt="NPM"></a></p>

<p><a name="issues"></a></p>

<h1>
<a name="known-issues" class="anchor" href="#known-issues"><span class="octicon octicon-link"></span></a>Known Issues</h1>

<p>Forage is new software and as such should be regarded as a work in progress. Administrators should be aware of the
following:</p>

<ul>
<li>
<strong>Installation on Windows</strong> Forages underlying libraries float in and out of workingness on Windows. Although you
<em>can</em> get Forage to work natively on Windows, its not really recommended. Thankfully, Forage can easily be virtualised
with Vagrant- check out <a href="https://github.com/fergiemcdowall/virtual-forage">virtual-forage</a>.</li>
</ul><h1>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h1>

<p>Forage.js is released under the MIT license:</p>

<p>Copyright (c) 2013 Fergus McDowall</p>

<p>Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:</p>

<p>The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.</p>

<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/fergiemcdowall">fergiemcdowall</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-42218858-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>